[
    {
        "description": "timeseries, 2 aggs",
        "query": {
            "queryType": "timeseries",
            "dataSource": "twitterstream",
            "intervals": ["2013-01-01T00:00:00.000/2013-01-04T00:00:00.000"],
            "granularity": "day",
            "aggregations": [
                {
                    "type": "doubleSum",
                    "name": "num_tweets",
                    "fieldName": "count"
                },
                {
                    "type": "doubleSum",
                    "name": "tweet_length",
                    "fieldName": "tweet_length"
                }
            ],
            "context": {
                "useCache": "true",
                "populateCache": "true",
                "timeout": 60000
            }
        },
        "expectedResults": [
            {
                "timestamp": "2013-01-01T00:00:00.000Z",
                "result": {
                    "tweet_length": 2411267.0,
                    "num_tweets": 37552.0
                }
            },
            {
                "timestamp": "2013-01-02T00:00:00.000Z",
                "result": {
                    "tweet_length": 2462741.0,
                    "num_tweets": 37996.0
                }
            },
            {
                "timestamp": "2013-01-03T00:00:00.000Z",
                "result": {
                    "tweet_length": 2310393.0,
                    "num_tweets": 35507.0
                }
            }
        ]
    },
    {
        "description": "topN, 2 aggs, lexicographic",
        "query": {
            "queryType": "topN",
            "dataSource": "twitterstream",
            "intervals": ["2013-01-01T00:00:00.000/2013-01-04T00:00:00.000"],
            "granularity": "day",
            "aggregations": [
                {
                    "type": "doubleSum",
                    "name": "num_tweets",
                    "fieldName": "count"
                },
                {
                    "type": "doubleSum",
                    "name": "tweet_length",
                    "fieldName": "tweet_length"
                }
            ],
            "postAggregations": [
                {
                    "type": "arithmetic",
                    "name": "avg_tweet_len",
                    "fn": "/",
                    "fields": [
                        {
                            "type": "fieldAccess",
                            "name": "tweet_length",
                            "fieldName": "tweet_length"
                        },
                        {
                            "type": "fieldAccess",
                            "name": "num_tweets",
                            "fieldName": "num_tweets"
                        }
                    ]
                }
            ],
            "dimension": "user_name",
            "metric": {
                "type": "lexicographic"
            },
            "threshold": 2,
            "context": {
                "useCache": "true",
                "populateCache": "true",
                "timeout": 60000
            }
        },
        "expectedResults": [
            {
                "timestamp": "2013-01-01T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "00000526",
                        "tweet_length": 15.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 15.0
                    },
                    {
                        "user_name": "000zeeezy000",
                        "tweet_length": 88.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 88.0
                    }
                ]
            },
            {
                "timestamp": "2013-01-02T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "001032004",
                        "tweet_length": 53.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 53.0
                    },
                    {
                        "user_name": "001inci",
                        "tweet_length": 72.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 72.0
                    }
                ]
            },
            {
                "timestamp": "2013-01-03T00:00:00.000Z",
                "result": [
                    {
                        "user_name": null,
                        "tweet_length": 0.0,
                        "num_tweets": 0.0,
                        "avg_tweet_len": 0.0
                    },
                    {
                        "user_name": "00001Saa",
                        "tweet_length": 99.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 99.0
                    }
                ]
            }
        ]
    },
    {
        "description": "topN, 2 aggs",
        "query": {
            "queryType": "topN",
            "dataSource": "twitterstream",
            "intervals": ["2013-01-01T00:00:00.000/2013-01-04T00:00:00.000"],
            "granularity": "day",
            "aggregations": [
                {
                    "type": "doubleSum",
                    "name": "num_tweets",
                    "fieldName": "count"
                },
                {
                    "type": "doubleSum",
                    "name": "tweet_length",
                    "fieldName": "tweet_length"
                }
            ],
            "postAggregations": [
                {
                    "type": "arithmetic",
                    "name": "avg_tweet_len",
                    "fn": "/",
                    "fields": [
                        {
                            "type": "fieldAccess",
                            "name": "tweet_length",
                            "fieldName": "tweet_length"
                        },
                        {
                            "type": "fieldAccess",
                            "name": "num_tweets",
                            "fieldName": "num_tweets"
                        }
                    ]
                }
            ],
            "dimension": "user_name",
            "metric": {
                "type": "numeric",
                "metric": "num_tweets"
            },
            "threshold": 2,
            "context": {
                "useCache": "true",
                "populateCache": "true",
                "timeout": 60000
            }
        },
        "expectedResults": [
            {
                "timestamp": "2013-01-01T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "jRabbitBabee",
                        "tweet_length": 676.0,
                        "num_tweets": 5.0,
                        "avg_tweet_len": 135.2
                    },
                    {
                        "user_name": "RadioShababBgd",
                        "tweet_length": 320.0,
                        "num_tweets": 4.0,
                        "avg_tweet_len": 80.0
                    }
                ]
            },
            {
                "timestamp": "2013-01-02T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "Elviaci9",
                        "tweet_length": 464.0,
                        "num_tweets": 4.0,
                        "avg_tweet_len": 116.0
                    },
                    {
                        "user_name": "Smeraldakn4",
                        "tweet_length": 245.0,
                        "num_tweets": 4.0,
                        "avg_tweet_len": 61.25
                    }
                ]
            },
            {
                "timestamp": "2013-01-03T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "LoOfying",
                        "tweet_length": 535.0,
                        "num_tweets": 6.0,
                        "avg_tweet_len": 89.16666666666667
                    },
                    {
                        "user_name": "worldfansalice",
                        "tweet_length": 95.0,
                        "num_tweets": 4.0,
                        "avg_tweet_len": 23.75
                    }
                ]
            }
        ]
    },
    {
        "description": "topN, 2 aggs, filtered",
        "query": {
            "queryType": "topN",
            "dataSource": "twitterstream",
            "intervals": ["2013-01-01T00:00:00.000/2013-01-04T00:00:00.000"],
            "granularity": "day",
            "filter": {
                "type": "or",
                "fields": [
                    {
                        "type": "selector",
                        "dimension": "user_name",
                        "value": "jRabbitBabee"
                    },
                    {
                        "type": "selector",
                        "dimension": "user_name",
                        "value": "SportsAB"
                    },
                    {
                        "type": "selector",
                        "dimension": "user_name",
                        "value": "furin0620"
                    }
                ]
            },
            "aggregations": [
                {
                    "type": "doubleSum",
                    "name": "num_tweets",
                    "fieldName": "count"
                },
                {
                    "type": "doubleSum",
                    "name": "tweet_length",
                    "fieldName": "tweet_length"
                }
            ],
            "postAggregations": [
                {
                    "type": "arithmetic",
                    "name": "avg_tweet_len",
                    "fn": "/",
                    "fields": [
                        {
                            "type": "fieldAccess",
                            "name": "tweet_length",
                            "fieldName": "tweet_length"
                        },
                        {
                            "type": "fieldAccess",
                            "name": "num_tweets",
                            "fieldName": "num_tweets"
                        }
                    ]
                }
            ],
            "dimension": "user_name",
            "metric": {
                "type": "numeric",
                "metric": "num_tweets"
            },
            "threshold": 2,
            "context": {
                "useCache": "true",
                "populateCache": "true",
                "timeout": 60000
            }
        },
        "expectedResults": [
            {
                "timestamp": "2013-01-01T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "jRabbitBabee",
                        "tweet_length": 676.0,
                        "num_tweets": 5.0,
                        "avg_tweet_len": 135.2
                    },
                    {
                        "user_name": "furin0620",
                        "tweet_length": 28.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 28.0
                    }
                ]
            },
            {
                "timestamp": "2013-01-02T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "SportsAB",
                        "tweet_length": 46.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 46.0
                    }
                ]
            },
            {
                "timestamp": "2013-01-03T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "SportsAB",
                        "tweet_length": 46.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 46.0
                    },
                    {
                        "user_name": "furin0620",
                        "tweet_length": 29.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 29.0
                    }
                ]
            }
        ]
    },
    {
        "description": "groupBy",
        "query": {
            "queryType": "groupBy",
            "dataSource": "twitterstream",
            "intervals": ["2013-01-01T00:00:00.000/2013-01-04T00:00:00.000"],
            "granularity": "day",
            "aggregations": [
                {
                    "type": "doubleSum",
                    "name": "num_tweets",
                    "fieldName": "count"
                },
                {
                    "type": "doubleSum",
                    "name": "tweet_length",
                    "fieldName": "tweet_length"
                }
            ],
            "dimensions": ["has_links"]
        },
        "expectedResults": [
            {
                "version": "v1",
                "timestamp": "2013-01-01T00:00:00.000Z",
                "event": {
                    "has_links": "No",
                    "tweet_length": 2091075.0,
                    "num_tweets": 33745.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-01T00:00:00.000Z",
                "event": {
                    "has_links": "Yes",
                    "tweet_length": 320192.0,
                    "num_tweets": 3807.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-02T00:00:00.000Z",
                "event": {
                    "has_links": "No",
                    "tweet_length": 2105024.0,
                    "num_tweets": 33761.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-02T00:00:00.000Z",
                "event": {
                    "has_links": "Yes",
                    "tweet_length": 357717.0,
                    "num_tweets": 4235.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-03T00:00:00.000Z",
                "event": {
                    "has_links": "No",
                    "tweet_length": 1962363.0,
                    "num_tweets": 31454.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-03T00:00:00.000Z",
                "event": {
                    "has_links": "Yes",
                    "tweet_length": 348030.0,
                    "num_tweets": 4053.0
                }
            }
        ]
    },
    {
        "query": {
            "queryType": "search",
            "intervals": ["2013-01-01T00:00:00.000/2013-01-04T00:00:00.000"],
            "dataSource": "twitterstream",
            "granularity": "all",
            "searchDimensions": ["user_name"],
            "sort": {
                "type": "lexicographic"
            },
            "query": {
                "type": "insensitive_contains",
                "value": "Sports"
            },
            "limit": 3,
            "context": {
                "useCache": "true",
                "populateCache": "true",
                "timeout": 60000
            }
        },
        "expectedResults": [
            {
                "timestamp": "2013-01-01T00:00:00.000Z",
                "result": [
                    {
                        "dimension": "user_name",
                        "value": "AJonesFoxSports",
			            "count":1
                    },
                    {
                        "dimension": "user_name",
                        "value": "BetfairSports",
                        "count":1
                    },
                    {
                        "dimension": "user_name",
                        "value": "HamTodaySports",
			            "count":1
                    }
                ]
            }
        ]
    },
    {
        "description": "groupByArbitraryInterval",
        "query": {
            "queryType": "groupBy",
            "dataSource": "twitterstream",
            "intervals": ["2013-01-01T15:10:10.090/2013-01-03T19:30:01.090"],
            "granularity": "day",
            "aggregations": [
                {
                    "type": "doubleSum",
                    "name": "num_tweets",
                    "fieldName": "count"
                },
                {
                    "type": "doubleSum",
                    "name": "tweet_length",
                    "fieldName": "tweet_length"
                }
            ],
            "dimensions": ["has_links"]
        },
        "expectedResults": [
            {
                "version": "v1",
                "timestamp": "2013-01-01T00:00:00.000Z",
                "event": {
                    "has_links": "No",
                    "tweet_length": 751072.0,
                    "num_tweets": 11694.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-01T00:00:00.000Z",
                "event": {
                    "has_links": "Yes",
                    "tweet_length": 115479.0,
                    "num_tweets": 1352.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-02T00:00:00.000Z",
                "event": {
                    "has_links": "No",
                    "tweet_length": 2105024.0,
                    "num_tweets": 33761.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-02T00:00:00.000Z",
                "event": {
                    "has_links": "Yes",
                    "tweet_length": 357717.0,
                    "num_tweets": 4235.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-03T00:00:00.000Z",
                "event": {
                    "has_links": "No",
                    "tweet_length": 1588225.0,
                    "num_tweets": 25676.0
                }
            },
            {
                "version": "v1",
                "timestamp": "2013-01-03T00:00:00.000Z",
                "event": {
                    "has_links": "Yes",
                    "tweet_length": 284189.0,
                    "num_tweets": 3279.0
                }
            }
        ]
    },
    {
        "description": "topN, 2 aggs, topN over dependent postAgg",
        "query": {
            "queryType": "topN",
            "dataSource": "twitterstream",
            "intervals": ["2013-01-01T00:00:00.000/2013-01-04T00:00:00.000"],
            "granularity": "day",
            "aggregations": [
                {
                    "type": "doubleSum",
                    "name": "num_tweets",
                    "fieldName": "count"
                },
                {
                    "type": "doubleSum",
                    "name": "tweet_length",
                    "fieldName": "tweet_length"
                }
            ],
            "postAggregations": [
                {
                    "type": "arithmetic",
                    "name": "avg_tweet_len",
                    "fn": "/",
                    "fields": [
                        {
                            "type": "fieldAccess",
                            "name": "tweet_length",
                            "fieldName": "tweet_length"
                        },
                        {
                            "type": "fieldAccess",
                            "name": "num_tweets",
                            "fieldName": "num_tweets"
                        }
                    ]
                },
                {
                    "type": "arithmetic",
                    "name": "avg_tweet_len_half",
                    "fn": "/",
                    "fields": [
                        {
                            "type": "fieldAccess",
                            "name": "avg_tweet_len",
                            "fieldName": "avg_tweet_len"
                        },
                        {
                            "type": "constant",
                            "value": "2"
                        }
                    ]
                },
                {
                    "type": "arithmetic",
                    "name": "avg_tweet_len_doubled",
                    "fn": "*",
                    "fields": [
                        {
                            "type": "fieldAccess",
                            "name": "avg_tweet_len",
                            "fieldName": "avg_tweet_len"
                        },
                        {
                            "type": "constant",
                            "value": "2"
                        }
                    ]
                }
            ],
            "dimension": "user_name",
            "metric": {
                "type": "numeric",
                "metric": "avg_tweet_len_doubled"
            },
            "threshold": 2,
            "context": {
                "useCache": "true",
                "populateCache": "true",
                "timeout": 60000
            }
        },
        "expectedResults": [
            {
                "timestamp": "2013-01-01T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "Tlowe14",
                        "tweet_length": 179.0,
                        "avg_tweet_len_half": 89.5,
                        "avg_tweet_len_doubled": 358.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 179.0
                    },
                    {
                        "user_name": "ItsUniToYou",
                        "tweet_length": 165.0,
                        "avg_tweet_len_half": 82.5,
                        "avg_tweet_len_doubled": 330.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 165.0
                    }
                ]
            },
            {
                "timestamp": "2013-01-02T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "SigaMike",
                        "tweet_length": 514.0,
                        "avg_tweet_len_half": 257.0,
                        "avg_tweet_len_doubled": 1028.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 514.0
                    },
                    {
                        "user_name": "wh0sddl",
                        "tweet_length": 265.0,
                        "avg_tweet_len_half": 132.5,
                        "avg_tweet_len_doubled": 530.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 265.0
                    }
                ]
            },
            {
                "timestamp": "2013-01-03T00:00:00.000Z",
                "result": [
                    {
                        "user_name": "jackychan149",
                        "tweet_length": 260.0,
                        "avg_tweet_len_half": 130.0,
                        "avg_tweet_len_doubled": 520.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 260.0
                    },
                    {
                        "user_name": "MCroyle2326",
                        "tweet_length": 220.0,
                        "avg_tweet_len_half": 110.0,
                        "avg_tweet_len_doubled": 440.0,
                        "num_tweets": 1.0,
                        "avg_tweet_len": 220.0
                    }
                ]
            }
        ]
    }
]
